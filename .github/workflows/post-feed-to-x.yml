name: Post RSS Feed to X

on:
  workflow_dispatch:
  schedule:
    - cron: '*/15 * * * *'

jobs:
  post_feed:
    runs-on: ubuntu-latest
    env:
      X_API_KEY: ${{ secrets.X_API_KEY }}
      X_API_SECRET: ${{ secrets.X_API_SECRET }}
      X_ACCESS_TOKEN: ${{ secrets.X_ACCESS_TOKEN }}
      X_ACCESS_TOKEN_SECRET: ${{ secrets.X_ACCESS_TOKEN_SECRET }}
    steps:
    - uses: actions/checkout@v3
    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'
    - name: Install dependencies
      run: pip install feedparser tweepy
    - name: Post feed to X
      run: |
        python post_feed_to_x.py "https://example.com/rss.xml" "https://example.com/toc.xml" 30